/*
 *  Licensed to the OpenXdata Foundation (OXDF) under one or more
 *  contributor license agreements.  See the NOTICE file distributed with
 *  this work for additional information regarding copyright ownership.
 *  The OXDF licenses this file to You under the Apache License, Version 2.0
 *  (the "License"); you may not use this file except in compliance with the License. 
 *  You may obtain a copy of the License at
 *
 *    http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, 
 *  software distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and limitations under the License.
 *
 *  Copyright 2010 http://www.openxdata.org.
 */
package org.openxdata.server.export;

import java.io.ByteArrayOutputStream;
import java.io.PrintWriter;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.List;

import org.easymock.EasyMock;
import org.junit.Assert;
import org.junit.Before;
import org.junit.Test;
import org.openxdata.server.admin.model.FormDefVersion;
import org.openxdata.server.service.DataExportService;


/**
 * Tests exporting of data to csv.
 * 
 * @author dagmar
 */
public class CVSDataExportTest {

	CSVDataExport dataExport = new CSVDataExport();
	DataExportService dataExportService;
	
	@Before
	public void setupMocks() {
		dataExportService = EasyMock.createMock(DataExportService.class);
		dataExport.setDataExportService(dataExportService);
	}
	
	@Test
	public void test_variedFormatDataXML() throws Exception {
		// setup mock
		EasyMock.expect(dataExportService.getFormDefVersion(1)).andReturn(getFormDef());
		EasyMock.expect(dataExportService.getFormDataWithAuditing(1, null, null, null)).andReturn(getData());
		EasyMock.replay(dataExportService);
		
		// test
		ByteArrayOutputStream bout = new ByteArrayOutputStream();
		PrintWriter pout = new PrintWriter(bout);
		dataExport.export(pout, 1, null, null, null);
		
		// asserts
		pout.flush();
		String output = new String(bout.toByteArray());
		Assert.assertTrue("header is outputted correctly", output.contains("ID,CAPTURER,CREATION DATE,NAME,SESSION_DATE,TRADITIONAL_AUTHORITY,TRADITIONAL_AUTHORITY_OTHER,SESSION_LOCATION,SESSION_LOCATION_OTHER,CLINIC_HOSPITAL_DEPARTMENT,CLINIC_HOSPITAL_DEPARTMENT_OTHER,SESSION_PLACE_NAME,SITE_ELECTRICITY,EQUIPMENT_USED_AV_KIT_TIGONJETSE_DVDS,EQUIPMENT_USED_ONLY_TIGONJETSE_DVDS,EQUIPMENT_USED_CMT_FLIPCHART,EQUIPMENT_USED_NONE,SESSION_START_TIME,SESSION_FINISH_TIME,CMT_CO_FACILITATOR,CO_FACILITATOR_NAME,PARTICIPANT_NUMBER_MALE,PARTICIPANT_NUMBER_FEMALE,MALE_PARTICIPANTS_YOUTH,FEMALE_PARTICIPANTS_YOUTH,SESSION_TOPIC_ALCOHOL_SUBSTANCE_ABUSE,SESSION_TOPIC_ARV_READINESS_ADHERENCE,SESSION_TOPIC_CHILDREN_HIV_INCL_ARVS,SESSION_TOPIC_HIV_IMMUNE_SYSTEM,SESSION_TOPIC_HUMAN_RIGHTS,SESSION_TOPIC_NUTRITION,SESSION_TOPIC_OPPORTUNISTIC_INFECTIONS,SESSION_TOPIC_PALLIATIVE_HOME_BASED_CARE,SESSION_TOPIC_PEP_RAPE,SESSION_TOPIC_PMTCT_MATERNAL_HEALTH,SESSION_TOPIC_POSITIVE_LIVINGINCLUDES_POSITIVE_PREVENTION,SESSION_TOPIC_PREVENTION_CONDOMS,SESSION_TOPIC_STIS,SESSION_TOPIC_TB,SESSION_TOPIC_TEENAGE_PREGNANCY,SESSION_TOPIC_HIV_TESTING_AND_COUNSELLING,SESSION_TOPIC_WOMENS_HEALTH,SESSION_TOPIC_OTHER,SESSION_TOPIC_OTHER,TYPE_OF_SESSION_ONE-ON-ONE,TYPE_OF_SESSION_SUPPORT_GROUP,TYPE_OF_SESSION_PEER_EDUCATION_GROUP_TRAINING,TYPE_OF_SESSION_ONCE_-OFF_GROUP,SEEN_THE_INDIVIDUAL_GROUP_BEFORE,ONE_ON_ONE_FOLLOW_UP_SESSION_TOPIC_PMTCT,ONE_ON_ONE_FOLLOW_UP_SESSION_TOPIC_ARV_ADHERENCE,ONE_ON_ONE_FOLLOW_UP_SESSION_TOPIC_OTHERSPECIFY,OTHER_SPECIFY,SESSION_CONFIRMED"));
		Assert.assertTrue("line1 is outputted correctly", output.contains("498,PETERC1,08/09/2010,Peter Malenga,2010-07-02,nchiramwera,,community_youth_centre,,,,Thyolo NAPHAM,true,1,0,0,0,10:00:00,11:00:00,true,Christina Walala,22,0,2,10,0,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,,,0,1,0,0,false,0,0,0,,true"));
		Assert.assertTrue("line2 is outputted correctly", output.contains("499,PETERC1,08/09/2010,Smart Beaton,2010-07-12,mphuka,,primary_school,,,,Mulenga,false,0,0,0,1,01:30:00,02:00:00,false,,16,20,15,21,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,,,0,0,0,1,false,0,0,0,,true"));
		Assert.assertTrue("line3 is outputted correctly", output.contains("500,PETERC1,08/09/2010,Smart Beaton,2010-07-12,mphuka,,primary_school,,,,Mulenga,false,0,0,0,1,13:00:00,13:35:00,false,,33,33,32,34,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,,,0,0,1,0,false,0,0,0,,true"));
		
		// verify mock
		EasyMock.verify(dataExportService);
	}

	private List<Object[]> getData() throws Exception {
		List<Object[]> data = new ArrayList<Object[]>();
		// first data set
		Object[] data1 = new Object[4];
		data1[0] = 498;
		data1[1] = "PETERC1";
		data1[2] = new SimpleDateFormat("dd/MM/yyyy").parse("08/09/2010");
		data1[3] = "<?xml version='1.0' encoding='UTF-8' ?><cmt_malawi_tlpp_session_report_v1 formKey=\"cmt_malawi_cmt_tlpp_session_report_malawi_v1\" id=\"13\" name=\"Treatment literacy programme_v1\" xmlns:xf=\"http://www.w3.org/2002/xforms\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">  <name>Peter Malenga</name>  <session_date>2010-07-02</session_date>  <traditional_authority>nchiramwera</traditional_authority>  <traditional_authority_other/>  <session_location>community_youth_centre</session_location>  <session_location_other/>  <session_place_name>Thyolo NAPHAM</session_place_name>  <site_electricity>true</site_electricity>  <participant_number_male>22</participant_number_male>  <participant_number_female>0</participant_number_female>  <male_participants_youth>2</male_participants_youth>  <female_participants_youth>10</female_participants_youth>  <session_start_time>10:00:00</session_start_time>  <session_finish_time>11:00:00</session_finish_time>  <session_topic>nutrition ARV_readiness_adherence prevention_condoms</session_topic>  <session_topic_other/>  <type_of_session>support_group</type_of_session>  <seen_the_individual_group_before>false</seen_the_individual_group_before>  <one_on_one_follow_up_session_topic/>  <other_specify/>  <CMT_co_facilitator>true</CMT_co_facilitator>  <co_facilitator_name>Christina Walala</co_facilitator_name>  <clinic_hospital_department/>  <clinic_hospital_department_other/>  <equipment_used>av_kit_tigonjetse_dvds</equipment_used>  <session_confirmed>true</session_confirmed></cmt_malawi_tlpp_session_report_v1>";
		data.add(data1);
		// second data set
		Object[] data2 = new Object[4];
		data2[0] = 499;
		data2[1] = "PETERC1";
		data2[2] = new SimpleDateFormat("dd/MM/yyyy").parse("08/09/2010");
		data2[3] = "<?xml version='1.0' encoding='UTF-8' ?><cmt_malawi_tlpp_session_report_v1 formKey=\"cmt_malawi_cmt_tlpp_session_report_malawi_v1\" id=\"13\" name=\"Treatment literacy programme_v1\" xmlns:xf=\"http://www.w3.org/2002/xforms\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">        <name>Smart Beaton</name>        <session_date>2010-07-12</session_date>        <traditional_authority>mphuka</traditional_authority>        <traditional_authority_other/>        <session_location>primary_school</session_location>        <session_location_other/>        <clinic_hospital_department/>        <clinic_hospital_department_other/>        <session_place_name>Mulenga</session_place_name>        <site_electricity>false</site_electricity>        <equipment_used>none</equipment_used>        <session_start_time>01:30:00</session_start_time>        <session_finish_time>02:00:00</session_finish_time>        <CMT_co_facilitator>false</CMT_co_facilitator>        <co_facilitator_name/>        <participant_number_male>16</participant_number_male>        <participant_number_female>20</participant_number_female>        <male_participants_youth>15</male_participants_youth>        <female_participants_youth>21</female_participants_youth>        <session_topic>HIV_immune_system</session_topic>        <session_topic_other/>        <type_of_session>once_-off_group</type_of_session>        <seen_the_individual_group_before>false</seen_the_individual_group_before>        <one_on_one_follow_up_session_topic/>       <other_specify/>        <session_confirmed>true</session_confirmed>      </cmt_malawi_tlpp_session_report_v1>";
		data.add(data2);
		// third data set
		Object[] data3 = new Object[4];
		data3[0] = 500;
		data3[1] = "PETERC1";
		data3[2] = new SimpleDateFormat("dd/MM/yyyy").parse("08/09/2010");
		data3[3] = "<?xml version='1.0' encoding='UTF-8' ?><cmt_malawi_tlpp_session_report_v1 formKey=\"cmt_malawi_cmt_tlpp_session_report_malawi_v1\" id=\"13\" name=\"Treatment literacy programme_v1\" xmlns:xf=\"http://www.w3.org/2002/xforms\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">  <name>Smart Beaton</name>  <session_date>2010-07-12</session_date>  <traditional_authority>mphuka</traditional_authority>  <traditional_authority_other/>  <session_location>primary_school</session_location>  <session_location_other/>  <session_place_name>Mulenga</session_place_name>  <site_electricity>false</site_electricity>  <participant_number_male>33</participant_number_male>  <participant_number_female>33</participant_number_female>  <male_participants_youth>32</male_participants_youth>  <female_participants_youth>34</female_participants_youth>  <session_start_time>13:00:00</session_start_time>  <session_finish_time>13:35:00</session_finish_time>  <session_topic>HIV_immune_system</session_topic>  <session_topic_other/>  <type_of_session>peer_education_group_training</type_of_session>  <seen_the_individual_group_before>false</seen_the_individual_group_before>  <one_on_one_follow_up_session_topic/>  <other_specify/>  <CMT_co_facilitator>false</CMT_co_facilitator>  <co_facilitator_name/>  <clinic_hospital_department/>  <clinic_hospital_department_other/>  <equipment_used>none</equipment_used>  <session_confirmed>true</session_confirmed></cmt_malawi_tlpp_session_report_v1>";
		data.add(data3);
		return data;
	}
	
	private FormDefVersion getFormDef() {
		FormDefVersion fdv = new FormDefVersion();
		fdv.setXform("<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><xf:xforms xmlns:xf=\"http://www.w3.org/2002/xforms\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\">  <xf:model>    <xf:instance id=\"cmt_malawi_tlpp_session_report_v1\">      <cmt_malawi_tlpp_session_report_v1 formKey=\"cmt_malawi_cmt_tlpp_session_report_malawi_v1\" id=\"13\" name=\"Treatment literacy programme_v1\">        <name/>        <session_date/>        <traditional_authority/>        <traditional_authority_other/>        <session_location/>        <session_location_other/>        <clinic_hospital_department/>        <clinic_hospital_department_other/>        <session_place_name/>        <site_electricity/>        <equipment_used/>        <session_start_time/>        <session_finish_time/>        <CMT_co_facilitator/>        <co_facilitator_name/>        <participant_number_male/>        <participant_number_female/>        <male_participants_youth/>        <female_participants_youth/>        <session_topic/>        <session_topic_other/><type_of_session/>        <seen_the_individual_group_before/>        <one_on_one_follow_up_session_topic/>        <other_specify/>        <session_confirmed/>      </cmt_malawi_tlpp_session_report_v1>    </xf:instance>    <xf:bind id=\"name\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/name\" required=\"true()\" type=\"xsd:string\"/>    <xf:bind id=\"session_date\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_date\" required=\"true()\" type=\"xsd:date\"/>    <xf:bind id=\"traditional_authority\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/traditional_authority\" required=\"true()\" type=\"xsd:string\"/>    <xf:bind action=\"show\" id=\"traditional_authority_other\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/traditional_authority_other\" relevant=\"/cmt_malawi_tlpp_session_report_v1/traditional_authority = 'other'\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind id=\"session_location\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_location\" required=\"true()\" type=\"xsd:string\"/>    <xf:bind action=\"show\" id=\"session_location_other\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_location_other\" relevant=\"/cmt_malawi_tlpp_session_report_v1/session_location = 'other'\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind action=\"enable\" id=\"clinic_hospital_department\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/clinic_hospital_department\" relevant=\"/cmt_malawi_tlpp_session_report_v1/session_location = 'hospital'\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind action=\"show\" id=\"clinic_hospital_department_other\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/clinic_hospital_department_other\" relevant=\"/cmt_malawi_tlpp_session_report_v1/clinic_hospital_department = 'other'\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind id=\"session_place_name\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_place_name\" required=\"true()\" type=\"xsd:string\"/>    <xf:bind id=\"site_electricity\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/site_electricity\" required=\"true()\" type=\"xsd:boolean\"/>    <xf:bind id=\"equipment_used\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/equipment_used\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind id=\"session_start_time\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_start_time\" required=\"true()\" type=\"xsd:time\"/>    <xf:bind id=\"session_finish_time\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_finish_time\" required=\"true()\" type=\"xsd:time\"/>    <xf:bind id=\"CMT_co_facilitator\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/CMT_co_facilitator\" required=\"true()\" type=\"xsd:boolean\"/>    <xf:bind action=\"show\" id=\"co_facilitator_name\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/co_facilitator_name\" relevant=\"/cmt_malawi_tlpp_session_report_v1/CMT_co_facilitator = true\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind id=\"participant_number_male\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/participant_number_male\" required=\"true()\" type=\"xsd:int\"/>    <xf:bind id=\"participant_number_female\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/participant_number_female\" required=\"true()\" type=\"xsd:int\"/>    <xf:bind id=\"male_participants_youth\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/male_participants_youth\" required=\"true()\" type=\"xsd:int\"/>    <xf:bind id=\"female_participants_youth\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/female_participants_youth\" required=\"true()\" type=\"xsd:int\"/>    <xf:bind id=\"session_topic\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_topic\" required=\"true()\" type=\"xsd:string\"/>    <xf:bind action=\"show\" id=\"session_topic_other\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_topic_other\" relevant=\"/cmt_malawi_tlpp_session_report_v1/session_topic = 'other'\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind id=\"type_of_session\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/type_of_session\" required=\"true()\" type=\"xsd:string\"/>    <xf:bind id=\"seen_the_individual_group_before\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/seen_the_individual_group_before\" required=\"true()\" type=\"xsd:boolean\"/>    <xf:bind action=\"enable\" id=\"one_on_one_follow_up_session_topic\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/one_on_one_follow_up_session_topic\" relevant=\"/cmt_malawi_tlpp_session_report_v1/type_of_session = 'one-on-one' and /cmt_malawi_tlpp_session_report_v1/seen_the_individual_group_before = true\" type=\"xsd:string\" required=\"true()\"/>    <xf:bind action=\"show\" id=\"other_specify\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/other_specify\" relevant=\"/cmt_malawi_tlpp_session_report_v1/one_on_one_follow_up_session_topic = 'otherspecify'\" type=\"xsd:string\" required=\"false()\"/>    <xf:bind id=\"session_confirmed\" nodeset=\"/cmt_malawi_tlpp_session_report_v1/session_confirmed\" type=\"xsd:boolean\" required=\"true()\"/>  </xf:model>  <xf:group id=\"1\">    <xf:label>CMT TLPP Session Report - Malawi</xf:label>    <xf:input bind=\"name\">      <xf:label>Facilitator Name</xf:label>    </xf:input>    <xf:input bind=\"session_date\">      <xf:label>Date of session</xf:label>    </xf:input>    <xf:select1 bind=\"traditional_authority\">      <xf:label>Traditional Authority</xf:label>      <xf:item id=\"nsabwe\">        <xf:label>Nsabwe</xf:label>        <xf:value>nsabwe</xf:value>      </xf:item>      <xf:item id=\"th\">        <xf:label>Thukuta</xf:label>        <xf:value>th</xf:value>      </xf:item>      <xf:item id=\"mbawera\">        <xf:label>Mbawera</xf:label>        <xf:value>mbawera</xf:value>      </xf:item>      <xf:item id=\"changata\">        <xf:label>Changata</xf:label>        <xf:value>changata</xf:value>      </xf:item>      <xf:item id=\"mphuka\">        <xf:label>Mphuka</xf:label>        <xf:value>mphuka</xf:value>      </xf:item>      <xf:item id=\"kwethemule\">        <xf:label>Kwethemule</xf:label>        <xf:value>kwethemule</xf:value>      </xf:item>      <xf:item id=\"kapichi\">        <xf:label>Kapichi</xf:label>        <xf:value>kapichi</xf:value>      </xf:item>      <xf:item id=\"nchiramwera\">        <xf:label>Nchiramwera</xf:label>        <xf:value>nchiramwera</xf:value>      </xf:item>      <xf:item id=\"chimaliro\">        <xf:label>Chimaliro</xf:label>        <xf:value>chimaliro</xf:value>      </xf:item>      <xf:item id=\"bvumbwe\">        <xf:label>Bvumbwe</xf:label>        <xf:value>bvumbwe</xf:value>      </xf:item>      <xf:item id=\"thomasi\">        <xf:label>Thomas</xf:label>        <xf:value>thomasi</xf:value>      </xf:item>      <xf:item id=\"nanseta\">        <xf:label>Nanseta</xf:label>        <xf:value>nanseta</xf:value>      </xf:item>      <xf:item id=\"other\">        <xf:label>Other(please specify)</xf:label>        <xf:value>other</xf:value>      </xf:item>    </xf:select1>    <xf:input bind=\"traditional_authority_other\">      <xf:label>Please specify</xf:label>    </xf:input>    <xf:select1 bind=\"session_location\">      <xf:label>Where was the session</xf:label>      <xf:item id=\"hospital\">        <xf:label>Hospital</xf:label>        <xf:value>hospital</xf:value>      </xf:item>      <xf:item id=\"clinic_health_centre\">        <xf:label>Clinic/Health Centre</xf:label>        <xf:value>clinic_health_centre</xf:value>      </xf:item>      <xf:item id=\"improved_health_post_ihp\">        <xf:label>Improved Health Post (IHP)</xf:label>        <xf:value>improved_health_post_ihp</xf:value>      </xf:item>      <xf:item id=\"primary_school\">        <xf:label>Primary School</xf:label>        <xf:value>primary_school</xf:value>      </xf:item>      <xf:item id=\"secondary_school\">        <xf:label>Secondary School</xf:label>        <xf:value>secondary_school</xf:value>      </xf:item>      <xf:item id=\"prison\">        <xf:label>Prison</xf:label>        <xf:value>prison</xf:value>      </xf:item>      <xf:item id=\"church\">        <xf:label>Church</xf:label>        <xf:value>church</xf:value>      </xf:item>      <xf:item id=\"community_youth_centre\">        <xf:label>Community Centre/Youth Centre</xf:label>        <xf:value>community_youth_centre</xf:value>      </xf:item>      <xf:item id=\"shopping_centre_taxi_rank\">        <xf:label>Shopping Centre/Taxi Rank</xf:label>        <xf:value>shopping_centre_taxi_rank</xf:value>      </xf:item>      <xf:item id=\"community_based_organisation_cbo\">        <xf:label>Community Based Organisation (CBO)</xf:label>        <xf:value>community_based_organisation_cbo</xf:value>      </xf:item>      <xf:item id=\"other\">        <xf:label>Other (please specify)</xf:label>        <xf:value>other</xf:value>      </xf:item>    </xf:select1>    <xf:input bind=\"session_location_other\">      <xf:label>Please specify</xf:label>    </xf:input>    <xf:select1 bind=\"clinic_hospital_department\">      <xf:label>Where in the hospital was the session</xf:label>      <xf:hint>In which department was the session in the clinic/hospital held</xf:hint>      <xf:item id=\"PMTCT_antenatal\">        <xf:label>PMTCT/Antenatal</xf:label>        <xf:value>PMTCT_antenatal</xf:value>      </xf:item>      <xf:item id=\"ARV_ward\">        <xf:label>ARV Ward</xf:label>        <xf:value>ARV_ward</xf:value>      </xf:item>      <xf:item id=\"STI_ward\">        <xf:label>STI Ward</xf:label>        <xf:value>STI_ward</xf:value>      </xf:item>      <xf:item id=\"TB_ward\">        <xf:label>TB Ward</xf:label>        <xf:value>TB_ward</xf:value>      </xf:item>      <xf:item id=\"general_waiting\">        <xf:label>General/waiting</xf:label>        <xf:value>general_waiting</xf:value>      </xf:item>      <xf:item id=\"other\">        <xf:label>Other: specify</xf:label>        <xf:value>other</xf:value>      </xf:item>    </xf:select1>    <xf:input bind=\"clinic_hospital_department_other\">      <xf:label>Other (specify)</xf:label>    </xf:input>    <xf:input bind=\"session_place_name\">      <xf:label>Name of place where session held?</xf:label>    </xf:input>    <xf:input bind=\"site_electricity\">      <xf:label>Did this site have electricity</xf:label>    </xf:input>    <xf:select bind=\"equipment_used\">      <xf:label>Equipment Used</xf:label>      <xf:item id=\"av_kit_tigonjetse_dvds\">        <xf:label>AV Kit &amp; Tigonjetse DVDs</xf:label>        <xf:value>av_kit_tigonjetse_dvds</xf:value>      </xf:item>      <xf:item id=\"only_tigonjetse_dvds\">        <xf:label>Only Tigonjetse DVDs</xf:label>        <xf:value>only_tigonjetse_dvds</xf:value>      </xf:item>      <xf:item id=\"cmt_flipchart\">        <xf:label>CMT Flipchart</xf:label>        <xf:value>cmt_flipchart</xf:value>      </xf:item>      <xf:item id=\"none\">        <xf:label>NONE</xf:label>        <xf:value>none</xf:value>      </xf:item>    </xf:select>    <xf:input bind=\"session_start_time\">      <xf:label>What time did the session start</xf:label>      <xf:hint>HH:mm:ss of the session start time</xf:hint>    </xf:input>    <xf:input bind=\"session_finish_time\">      <xf:label>What time did the session finish</xf:label>      <xf:hint>HH:mm:ss of the session finish time</xf:hint>    </xf:input>    <xf:input bind=\"CMT_co_facilitator\">      <xf:label>Did another Tigonjetse TLPP co-facilitate the session with you</xf:label>      <xf:hint>Did another Tigonjetse TLPP co-facilitate the session with you?</xf:hint>    </xf:input>    <xf:input bind=\"co_facilitator_name\">      <xf:label>Name of Tigonjetse co-facilitator</xf:label>      <xf:hint>Name of Tigonjetse co-facilitator</xf:hint>    </xf:input>    <xf:input bind=\"participant_number_male\">      <xf:label>Number of session participants (Male)</xf:label>    </xf:input>    <xf:input bind=\"participant_number_female\">      <xf:label>Number of session participants (Female)</xf:label>    </xf:input>    <xf:input bind=\"male_participants_youth\">      <xf:label>How many Male participants were youth</xf:label>    </xf:input>    <xf:input bind=\"female_participants_youth\">      <xf:label>How many Female participants were youth</xf:label>    </xf:input>    <xf:select bind=\"session_topic\">      <xf:label>What was the session topic?</xf:label>      <xf:hint>Choose one or many to indicate the topic of discussion at the session</xf:hint>      <xf:item id=\"alcohol_substance_abuse\">        <xf:label>Alcohol &amp; Substance Abuse</xf:label>        <xf:value>alcohol_substance_abuse</xf:value>      </xf:item>      <xf:item id=\"ARV_readiness_adherence\">        <xf:label>ARV (Readiness , Adherence &amp; Side Effects)</xf:label>        <xf:value>ARV_readiness_adherence</xf:value>      </xf:item>      <xf:item id=\"children_HIV_incl_ARVs\">        <xf:label>Children &amp; HIV (incl. ARVs for children)</xf:label>        <xf:value>children_HIV_incl_ARVs</xf:value>      </xf:item>      <xf:item id=\"HIV_immune_system\">        <xf:label>HIV &amp; the Immune System/Human Anatomy/Virology</xf:label>        <xf:value>HIV_immune_system</xf:value>      </xf:item>      <xf:item id=\"human_rights\">        <xf:label>Human Rights</xf:label>        <xf:value>human_rights</xf:value>      </xf:item>      <xf:item id=\"nutrition\">        <xf:label>Nutrition</xf:label>        <xf:value>nutrition</xf:value>      </xf:item>      <xf:item id=\"opportunistic_infections\">        <xf:label>Opportunistic infections(Ols)</xf:label>        <xf:value>opportunistic_infections</xf:value>      </xf:item>      <xf:item id=\"palliative_home_based_care\">        <xf:label>Palliative &amp; home-based care</xf:label>        <xf:value>palliative_home_based_care</xf:value>      </xf:item>      <xf:item id=\"pep_rape\">        <xf:label>PEP &amp; Rape(includes gender based violence)</xf:label>        <xf:value>pep_rape</xf:value>      </xf:item>      <xf:item id=\"pmtct_maternal_health\">        <xf:label>PMTCT &amp; Maternal Health</xf:label>        <xf:value>pmtct_maternal_health</xf:value>      </xf:item>      <xf:item id=\"positive_livingincludes_positive_prevention\">        <xf:label>Positive Living(includes positive prevention)</xf:label>        <xf:value>positive_livingincludes_positive_prevention</xf:value>      </xf:item>      <xf:item id=\"prevention_condoms\">        <xf:label>Prevention: Correct and Consistent condom use</xf:label>        <xf:value>prevention_condoms</xf:value>      </xf:item>      <xf:item id=\"STIs\">        <xf:label>Sexually transmitted Infections(STI's)</xf:label>        <xf:value>STIs</xf:value>      </xf:item>      <xf:item id=\"TB\">        <xf:label>TB</xf:label>        <xf:value>TB</xf:value>      </xf:item>      <xf:item id=\"teenage_pregnancy\">        <xf:label>Teenage Pregnancy</xf:label>        <xf:value>teenage_pregnancy</xf:value>      </xf:item>      <xf:item id=\"hiv_testing_and_counselling\">        <xf:label>HIV Testing and Counselling(HCT)</xf:label>        <xf:value>hiv_testing_and_counselling</xf:value>      </xf:item>      <xf:item id=\"womens_health\">        <xf:label>Women's Health</xf:label>        <xf:value>womens_health</xf:value>      </xf:item>      <xf:item id=\"other\">        <xf:label>Other: specify</xf:label>        <xf:value>other</xf:value>      </xf:item>    </xf:select>    <xf:input bind=\"session_topic_other\">      <xf:label>Other: specify</xf:label>    </xf:input>    <xf:select bind=\"type_of_session\">      <xf:label>Type of session</xf:label>      <xf:item id=\"one-on-one\">        <xf:label>One-on-one</xf:label>        <xf:value>one-on-one</xf:value>      </xf:item>      <xf:item id=\"support_group\">        <xf:label>Support group</xf:label>        <xf:value>support_group</xf:value>      </xf:item>      <xf:item id=\"peer_education_group_training\">        <xf:label>Peer education group training</xf:label>        <xf:value>peer_education_group_training</xf:value>      </xf:item>      <xf:item id=\"once_-off_group\">        <xf:label>Once -off group</xf:label>        <xf:value>once_-off_group</xf:value>      </xf:item>    </xf:select>    <xf:input bind=\"seen_the_individual_group_before\">      <xf:label>Have you seen the individual/group before</xf:label>    </xf:input>    <xf:select bind=\"one_on_one_follow_up_session_topic\">      <xf:label>if one-on-one follow-up, what was the follow up on</xf:label>      <xf:item id=\"pmtct\">        <xf:label>PMTCT</xf:label>        <xf:value>pmtct</xf:value>     </xf:item>      <xf:item id=\"arv_adherence\">        <xf:label>ARV adherence</xf:label>        <xf:value>arv_adherence</xf:value>      </xf:item>      <xf:item id=\"otherspecify\">        <xf:label>Other(specify)</xf:label>        <xf:value>otherspecify</xf:value>      </xf:item>    </xf:select>    <xf:input bind=\"other_specify\">      <xf:label>Specify</xf:label>    </xf:input>    <xf:input bind=\"session_confirmed\">      <xf:label>Has this session been confirmed with a signature or stamp?</xf:label>    </xf:input>  </xf:group></xf:xforms>");
		return fdv;
	}
}
